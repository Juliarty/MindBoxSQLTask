Из задания не совсем понятно то, как представлены данные. 
Я буду исходить из того, что данные представлены в виде трёх таблиц (диаграмма представлена в файле MindBoxDbDiagram.drawio), 
поскольку для организации отношения многие ко многим обычно используется именно такой подход, если мы хотим избавиться от избыточности.

SQL запрос представлен в файле GetProductAndCategories.sql.
